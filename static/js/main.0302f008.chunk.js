(this["webpackJsonpbias-free-network"]=this["webpackJsonpbias-free-network"]||[]).push([[0],{126:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),s=n(12),i=n.n(s),a=(n(79),n(80),n(152)),c=n(34),u=n(66),l="#0B72B9",h=Object(u.a)({container:{paddingLeft:"3vw"},palette:{common:{blue:l,orange:"#ff9800",white:"#ffffff"},primary:{main:"#ff9800"},secondary:{main:"#ff9800"},text:{primary:"#ffffff"}},typography:{fontFamily:"Roboto",tab:{fontFamily:"Raleway",textTransform:"none",fontWeight:700,color:"white",fontSize:"1rem"},h2:{fontWeight:700,fontSize:"2.5rem",color:l,lineHeight:1.5},h3:{fontSize:"2.5rem",color:l},h4:{fontSize:"1.75rem",color:l,fontWeight:700},h6:{fontWeight:500,fontFamily:"Raleway",color:l},subtitle1:{fontSize:"1.25rem",fontWeight:300,color:"#868686"},subtitle2:{color:"white",fontWeight:300,fontSize:"1.25rem"},body1:Object(c.a)({fontSize:"1.25rem",color:"#868686",fontWeight:300,fontFamily:"Roboto"},"fontWeight",400),caption:{fontSize:"1rem",fontWeight:300,color:"#868686"},learnButton:{borderColor:l,borderWidth:2,textTransform:"none",color:l,borderRadius:50,fontFamily:"Roboto",fontWeight:"bold"}},overrides:{MuiInputLabel:{root:{color:l,fontSize:"1rem"}},MuiButton:{contained:{backgroundColor:"#ff9800",color:"#ffffff",fontSize:"0.7rem",fontWeight:400,letterSpacing:1,"&:hover":{backgroundColor:"#ff9800","@media (hover: none)":{backgroundColor:"#ff9800"}}}},MuiInput:{root:{color:"#868686",fontWeight:300,fontFamily:"Roboto"},underline:{"&:before":{borderBottom:"2px solid ".concat(l)},"&:hover:not($disabled):not($focused):not($error):before":{borderBottom:"2px solid ".concat(l)}}}}}),f=n(47),g=n(145),p=n(146),d=n(153);function b(e){var t=e.title;t=t||"Channels List";var n=Object(g.a)((function(e){return{appbar:Object(f.a)(Object(f.a)({},e.typography),{},{height:"45px",boxShadow:"none",color:e.palette.text.primary,lineHeight:"45px",fontWeight:400,fontSize:"1rem",paddingLeft:"5vw"}),placementContainer:{height:"45px"}}}))();return o.a.createElement(o.a.Fragment,null,o.a.createElement(p.a,{position:"fixed",className:n.appbar},o.a.createElement("div",null,t)),o.a.createElement(d.a,{component:"div",className:n.placementContainer}))}var m=n(43),y=n(150),S=n(130),v=n(156),k=n(147),T=n(155),C=n(148),R=n(149);function M(e){var t=e.item,n=e.isSelected,r=e.isFinalElement,s=e.selectedChannelsChanged,i=Object(S.a)((function(e){return{"MuiListItem-gutters":{paddingLeft:0},channelContainer:{fontSize:"1rem"},channelAvatar:{height:"50px",width:"50px"}}}))(),a=o.a.createElement("span",{className:i.channelContainer},t.channelName);return o.a.createElement(v.a,{key:t.id,button:!0,className:i["MuiListItem-gutters"],selected:n,onClick:function(){return s(t.id)}},o.a.createElement(k.a,null,o.a.createElement(T.a,{alt:t.channelName,src:t.imageUrl,className:i.channelAvatar})),o.a.createElement(C.a,{primary:a}),r&&o.a.createElement(R.a,{variant:"inset",component:"li"}))}var w=n(26),_=n(4),O=n(41),j=n(40),E=n(22),x=n(18),U=Object(E.atom)({key:"channelsSelection",default:[]}),I=n(8),N=function(){function e(){Object(_.a)(this,e),this[x.a]=!0,this.type="Init",this.error=null}return Object(I.a)(e,[{key:"produceWithType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{dataMutator:void 0,error:void 0},n=t.dataMutator,r=t.error;return Object(x.d)(this,(function(t){t.type=e,void 0!=n&&n(t),void 0!=r&&(t.error=r)}))}},{key:"produce",value:function(e){return Object(x.d)(this,e)}}]),e}(),B=function(){function e(t){Object(_.a)(this,e),this._generator=t,this._value=null,this.value=this.value.bind(this)}return Object(I.a)(e,[{key:"value",value:function(){return null==this._value&&(this._value=this._generator()),this._value}}]),e}(),J=n(14),F=n.n(J),W=n(23),A=function(){function e(){var t=this;Object(_.a)(this,e),this.requestPermissionForNotificationsIfNeeded=Object(W.a)(F.a.mark((function e(){var n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._aTokenRepository.getPermissionsGranted()){e.next=3;break}return console.log("Requesting already granted"),e.abrupt("return");case 3:return console.log("Requesting permission..."),e.next=6,Notification.requestPermission();case 6:return n=e.sent,t._aTokenRepository.setPermissionsGranted(n),console.log("Permission is ".concat(n)),e.abrupt("return","granted"===n);case 10:case"end":return e.stop()}}),e)}))),this.deleteToken=function(e){e.getToken().then((function(t){e.deleteToken(t).then((function(){console.log("Token deleted.")})).catch((function(e){console.log("Unable to delete token. ",e)}))})).catch((function(e){console.log("Error retrieving Instance ID token. ",e)}))},this.sendTokenToServer=this.sendTokenToServer.bind(this),this._aStorage=re[ne.Storage](),this._aTokenFormatter=re[ne.TokenFormatter],this._aTokenRepository=re[ne.TokenRepository],this._aSystemBus=re[ne.SystemBus],this._aMessaingHandler=re[ne.MessagingHandler];navigator.firebase.initializeApp({apiKey:"AIzaSyAVK6bqlba-rlDJgp6vPVgxAUzQS4bhcsQ",authDomain:"bias-free-news.firebaseapp.com",databaseURL:"https://bias-free-news.firebaseio.com",projectId:"bias-free-news",storageBucket:"bias-free-news.appspot.com",messagingSenderId:"329265328965",appId:"1:329265328965:android:9f4f475a0f76381770c42c"});var n=navigator.firebase.messaging();n.usePublicVapidKey(e.vapidKey),this.onTokenRefresh(n),this.onMessage(n)}return Object(I.a)(e,[{key:"onTokenRefresh",value:function(e){var t=this;e.onTokenRefresh((function(){e.getToken().then((function(e){console.log("Token refreshed."),t._aSystemBus.onTokenRefresh.send(e)}))}))}},{key:"onMessage",value:function(e){var t=this;e.onMessage((function(e){console.log("Message received. ",e),t._aMessaingHandler.onMessage.send(e)}))}}]),e}();A.vapidKey="BErhQNctr6h1-OlIfAfkGgdclkE9NSi6DqdFUD15IAT2b62vDaLB9sKW3VSN0JRJQJ_2hnW8KxxVwMro3ZapRaE";var K=function e(){Object(_.a)(this,e),this.to=function(e){return JSON.stringify(e)},this.from=function(e){return JSON.parse(e)}},z=function e(){var t=this;Object(_.a)(this,e),this.getSubscribedChannels=function(){var n=t._aStorage.get(e.keys.susbcribedChannels),r=t._aChannelsJsonMapper.from(n);return new Map(Object.entries(r))},this.updateSubscribedChannels=function(n){var r=t._aChannelsJsonMapper.to(n);t._aStorage.set(e.keys.susbcribedChannels,r)},this._aStorage=re[ne.Storage](),this._aChannelsJsonMapper=re[ne.ChannelsJsonMapper]()};z.keys={susbcribedChannels:"ChannelsRepository.subscribedChannels"};var D=z,P=function e(){Object(_.a)(this,e),this.to=function(e){return JSON.stringify(e)},this.from=function(e){return JSON.parse(e)}},H=function e(){var t=this;Object(_.a)(this,e),this.getUser=function(){var n=t._aStorage.get(e.key);if(null!=n)return t._aUserJsonMapper.from(n)},this.setUser=function(n){var r=t._aUserJsonMapper.to(n);t._aStorage.set(e.key,r)},this._aStorage=re[ne.Storage](),this._aUserJsonMapper=re[ne.UserJsonMapper]()};H.key="UserRepository.user";var q=H,G=function(){function e(){Object(_.a)(this,e)}return Object(I.a)(e,[{key:"format",value:function(e){}}]),e}(),L=function(){function e(){Object(_.a)(this,e),this._subscribers={},this.send=this.send.bind(this),this.subscribe=this.subscribe.bind(this)}return Object(I.a)(e,[{key:"subscribe",value:function(e){var t=this,n=e.onItem,r=e.onError,o=e.onComplete,s={onItem:n,onError:r,onComplete:o};return this._subscribers[s]=s,function(){void 0!==o&&o(),t._subscribers.delete(s)}}},{key:"send",value:function(e,t){var n=t.to,r=void 0===n?null:n;if(null!==r)this._deliverMessage(e,r);else for(var o in this._subscribers)this._deliverMessage(e,o)}},{key:"_deliverMessage",value:function(e,t){try{t.onItem(e)}catch(n){t.onError?t.onError(n):console.log(n)}}}]),e}(),V={subscribe:new L,onTokenRefresh:new L},Q=function(){function e(){Object(_.a)(this,e)}return Object(I.a)(e,[{key:"onMessage",value:function(e){}}]),e}(),$=function e(){var t=this;Object(_.a)(this,e),this._onTokenRefresh=function(){t._aTokenRepository.setTokenSentToSever(!1);var e=t._aChannelsRepository.getSubcribedChannels();t.subscribeAsync(e)},this.subscribeAsync=function(){var e=Object(W.a)(F.a.mark((function e(n){var r,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._aTokenRepository.getTokenSentToServer()){e.next=2;break}return e.abrupt("return");case 2:if(!n){e.next=9;break}if(r=t._aUserRepository.getUser(),!(o=t._aTokenRepository.getToken())){e.next=9;break}return e.next=8,t._aChannelsClient.subscribeAsync({userId:r.id,channels:n,token:o});case 8:t._aTokenRepository.setTokenSentToServer(!0);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this._aChannelsClient=re[ne.SubscriptionsClient](),this._aChannelsRepository=re[ne.ChannelsRepository](),this._aTokenRepository=re[ne.TokenRepository](),this._aUserRepository=re[ne.UserRepository](),re[ne.SystemBus]().onTokenRefresh.subscribe({onItem:this._onTokenRefresh})},Z=n(46),Y=n.n(Z),X=function(){function e(){Object(_.a)(this,e)}return Object(I.a)(e,[{key:"subscribeAsync",value:function(t){var n=t.userId,r=t.channels,o=t.token;return Y.a.get(e.endpoint,{userId:n,channels:r,token:o,Date:new Date})}}]),e}();X.endpoint="https://www.test.com";var ee=function e(){var t=this;Object(_.a)(this,e),this.getToken=function(){return t._aStorage.get(e.tokenKey)},this.setToken=function(n){return t._aStorage.set(n,e.tokenKey)},this.getTokenSentToServer=function(){return t._aStorage.get(e.tokenSentToServerKey)},this.setTokenSentToSever=function(n){return t._aStorage.set(e.tokenSentToServerKey,n)},this.getPermissionsGranted=function(){console.log("before"),t._aStorage.get(e.permissionsGrantedKey)},this.setPermissionsGranted=function(n){return t._aStorage.set(e.permissionsGrantedKey,n)},this._aStorage=re[ne.Storage]()};ee.tokenKey="TokenRepository.token",ee.tokenSentToServerKey="TokenRepository.tokenSentToServerKey",ee.permissionsGrantedKey="TokenRepository.permissionsGrantedKey";var te=function e(){Object(_.a)(this,e),this.get=function(e){return window.localStorage.getItem(e)},this.set=function(e,t){return window.localStorage.setItem(e,t)},this.remove=function(e){return window.localStorage.removeItem(e)},this.clear=function(){return window.localStorage.clear()}},ne={MessagingService:"MessagingManager",SystemBus:"SystemBus",Storage:"Storage",TokenFormatter:"TokenFormatter",ChannelsRepository:"ChannelsRepository",ChannelsJsonMapper:"ChannelJsonMapper",UserRepository:"UsersRepository",UserJsonMapper:"UserJsonMapper",SubscriptionsClient:"SubscriptionsClient",MessagingHandler:"MessagingSink",TokenRepository:"TokenRepository",SubscriptionService:"SubscriptionService"},re=new function e(){var t=this;Object(_.a)(this,e),this.asSingleton=function(e,n){var r=new B((function(){return n()}));t[e]=function(){return r.value()}},this.asFactory=function(e,n){t[e]=function(){return n()}},this.registerApplicationTypes=function(){return t.registerChannelsTypes().registerUserTypes().registerMessagingTypes().registerSystemBus()},this.registerChannelsTypes=function(){return t.registerChannelMapper().registerChannelRepository().registerSubscriptionService()},this.registerChannelMapper=function(){return t.asSingleton(ne.ChannelsJsonMapper,(function(){return new K})),t},this.registerChannelRepository=function(){return t.asSingleton(ne.ChannelsRepository,(function(){return new D})),t},this.registerSubscriptionService=function(){return t.asSingleton(ne.SubscriptionService,(function(){return new $})),t},this.registerUserTypes=function(){return t.registerUserMapper().registerUsersRepository()},this.registerUserMapper=function(){return t.asSingleton(ne.UserJsonMapper,(function(){return new P})),t},this.registerUsersRepository=function(){return t.asSingleton(ne.UserRepository,(function(){return new q})),t},this.registerMessagingTypes=function(){return t.registerMessagingManager().registerMessagingHandler().registerTokenRepository()},this.registerMessagingManager=function(){return t.asSingleton(ne.MessagingService,(function(){return new A})),t},this.registerMessagingHandler=function(){return t.asSingleton(ne.MessagingHandler,(function(){return new Q})),t},this.registerTokenRepository=function(){return t.asSingleton(ne.TokenRepository,(function(){return new ee})),t},this.registerSystemBus=function(){return t.asSingleton(ne.SystemBus,(function(){return V})),t},this.registerInfrastructureTypes=function(){return t.registerStorage().registerTokenFormatter().registerSubscriptionsClient()},this.registerStorage=function(){return t.asSingleton(ne.Storage,(function(){return new te})),t},this.registerTokenFormatter=function(){return t.asSingleton(ne.TokenFormatter,(function(){return new G})),t},this.registerSubscriptionsClient=function(){return t.asSingleton(ne.SubscriptionsClient,(function(){return new X})),t},this.registerApplicationTypes().registerInfrastructureTypes()},oe="SelectedChannelsUpdated",se=function(e){Object(O.a)(n,e);var t=Object(j.a)(n);function n(){var e;return Object(_.a)(this,n),(e=t.call(this))[x.c]=!0,e.selectedChannels=new Map,e}return n}(N);function ie(e){var t=e.category,n=e.items,s=function(){var e=re[ne.ChannelsRepository](),t=Object(E.useSetRecoilState)(U),n=Object(r.useState)(new se),o=Object(w.a)(n,2),s=o[0],i=o[1];function a(e){i(e),t(e.selectedChannels)}return Object(r.useEffect)((function(){var t=e.getSubscribedChannels();t&&a(s.produceWithType(oe,{dataMutator:function(e){return e.selectedChannels=t}}))}),[]),{state:s,selectedChannelsChanged:function(e){a(s.produceWithType(oe,{dataMutator:function(t){void 0==t.selectedChannels.get(e)?t.selectedChannels.set(e,!0):t.selectedChannels.delete(e)}}))}}}(),i=s.state,a=s.selectedChannelsChanged,c=Object(S.a)((function(e){return{headerContainer:{marginTop:"1rem"},header:{fontFamily:e.typography.fontFamily,fontSize:"0.8rem",padding:"0.2rem 1rem",verticalAlign:"middle",color:e.palette.common.white,backgroundColor:e.palette.primary.main}}}))(),u=o.a.createElement(m.a,{variant:"button",className:c.header},t),l=n.map((function(e,t){return o.a.createElement(M,{key:e.id,item:e,isFinalElement:t==n.length-1,isSelected:i.selectedChannels.has(e.id),selectedChannelsChanged:a})}));return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:c.headerContainer},u),o.a.createElement(y.a,null,l))}var ae=function(e){var t=e.channels,n=Object(g.a)((function(e){return{container:{paddingLeft:"3vw"}}}))(),r=t.map((function(e){return o.a.createElement(ie,{key:e.category,items:e.items,category:e.category})}));return o.a.createElement(d.a,{className:n.container},r)},ce=n(154),ue=n(151),le="Init",he="ChannelsSubscribeRequest",fe="ChannelsSubscribed",ge="ChannelsSubscribedError",pe=function(e){Object(O.a)(n,e);var t=Object(j.a)(n);function n(){var e;return Object(_.a)(this,n),(e=t.call(this))[x.c]=!0,e}return n}(N);var de=function(e){var t=function(){var e=re[ne.MessagingService](),t=re[ne.SubscriptionService](),n=re[ne.ChannelsRepository](),o=Object(E.useRecoilValue)(U),s=Object(r.useState)(new pe),i=Object(w.a)(s,2),a=i[0],c=i[1];function u(){return(u=Object(W.a)(F.a.mark((function r(){return F.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.prev=0;case 1:return r.next=3,e.requestPermissionForNotificationsIfNeeded();case 3:if(r.sent){r.next=7;break}r.next=1;break;case 7:return c(a.produceWithType(he)),r.next=10,t.subscribeAsync(o);case 10:n.updateSubscribedChannels(o),c(a.produceWithType(fe)),r.next=17;break;case 14:r.prev=14,r.t0=r.catch(0),c(a.produceWithType(ge,{error:r.t0}));case 17:case"end":return r.stop()}}),r,null,[[0,14]])})))).apply(this,arguments)}return{state:a,subscribeAsync:function(){return u.apply(this,arguments)},resetSnackbar:function(){c(a.produceWithType(le))}}}(),n=t.state,s=t.subscribeAsync,i=t.resetSnackbar,a=Object(g.a)((function(e){return{footer:{width:"100%",position:"fixed",bottom:"0"},subscribeButton:{width:"100%"}}}))(),c=o.a.createElement(ce.a,{open:n.type===fe,autoHideDuration:3e3,onClose:i,message:"Channels have been subscribed successfuly!"}),u=o.a.createElement(ce.a,{open:n.type===ge,autoHideDuration:3e3,onClose:i,message:"An error has occured during the subscription process, please try again later"});return o.a.createElement(d.a,{className:a.footer},c,u,o.a.createElement("div",{style:{padding:"5px"}},o.a.createElement(ue.a,{variant:"contained",disabled:n.type===he,onClick:s,className:a.subscribeButton},"SUBSCRIBE")))},be=function(){function e(){var t=this;Object(_.a)(this,e),this.requestPermissionForNotificationsIfNeeded=Object(W.a)(F.a.mark((function e(){var n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._aTokenRepository.getPermissionsGranted()){e.next=3;break}return console.log("Requesting already granted"),e.abrupt("return");case 3:return console.log("Requesting permission..."),e.next=6,Notification.requestPermission();case 6:return n=e.sent,t._aTokenRepository.setPermissionsGranted(n),console.log("Permission is ".concat(n)),e.abrupt("return","granted"===n);case 10:case"end":return e.stop()}}),e)}))),this.deleteToken=function(e){e.getToken().then((function(t){e.deleteToken(t).then((function(){console.log("Token deleted.")})).catch((function(e){console.log("Unable to delete token. ",e)}))})).catch((function(e){console.log("Error retrieving Instance ID token. ",e)}))},this._aStorage=re[ne.Storage](),this._aTokenFormatter=re[ne.TokenFormatter](),this._aTokenRepository=re[ne.TokenRepository](),this._aSystemBus=re[ne.SystemBus](),this._aMessaingHandler=re[ne.MessagingHandler]()}return Object(I.a)(e,[{key:"sendTokenRefreshed",value:function(e){this._aSystemBus.onTokenRefresh.send(e)}},{key:"sendMessage",value:function(e){this._aMessaingHandler.onMessage.send(e)}}]),e}();be.vapidKey="BErhQNctr6h1-OlIfAfkGgdclkE9NSi6DqdFUD15IAT2b62vDaLB9sKW3VSN0JRJQJ_2hnW8KxxVwMro3ZapRaE";var me=function(){function e(){Object(_.a)(this,e),this.endpoint="https://www.test.com"}return Object(I.a)(e,[{key:"subscribeAsync",value:function(e){e.userId,e.channels,e.token}}]),e}(),ye=new function e(){var t=this;Object(_.a)(this,e),this.initialize=function(){t._regiserMockChannelsClient()._registerMockMessagingService()},this._registerMockMessagingService=function(){return re.asSingleton(ne.MessagingService,(function(){return new be})),t},this._regiserMockChannelsClient=function(){return re.asSingleton(ne.SubscriptionsClient,(function(){return new me})),t}};var Se=function(){var e=Object(r.useState)(!1),t=Object(w.a)(e,2),n=t[0],o=t[1];return Object(r.useEffect)((function(){n||(ye.initialize(),o(!0))}),[n,o]),n};var ve=function(){var e=Se();return Object(x.b)(),o.a.createElement(E.RecoilRoot,null,o.a.createElement("div",null,e&&o.a.createElement(a.a,{theme:h},o.a.createElement(b,null),o.a.createElement(ae,{channels:[{category:"YOUTUBE",items:[{id:1,imageUrl:"/assets/1.jpg",channelName:"Joe Rogan"},{id:2,imageUrl:"/assets/2.jpg",channelName:"Mark Dice"},{id:3,imageUrl:"/assets/3.jpg",channelName:"Louder With Crouwder"}]}]}),o.a.createElement(de,null))))};i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(ve,null)),document.getElementById("root"))},74:function(e,t,n){e.exports=n(126)},79:function(e,t,n){},80:function(e,t,n){}},[[74,1,2]]]);
//# sourceMappingURL=main.0302f008.chunk.js.map